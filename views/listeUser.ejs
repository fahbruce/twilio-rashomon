<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/list_user.css">
  <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <title>Rashômon : Liste Utilisateurs</title>
</head>
<body>
  <div class="container clearfix">
    <div class="chat">
        <div class="chat-header clearfix">
            <div class="chat-about">
                <div class="chat-with">Admin</div>
                <div class="chat-num-messages"><span>Liste des utilisateurs</span></div>
                <input type="search" class="form-control" id="searchUser" placeholder="Rechercher">
                <i class="fa fa-search ico-search"></i>
                <a href="/lst-user" class="l-ico-refresh"><i class="fa fa-refresh ico-refresh"></i></a>
            </div>
            <div class="action-lst">
                <button class="btn-add"><a href="/inscription">Ajouter</a></button>
                <button class="btn-acc"><a href="/">Accueil</a></button>
            </div>
        </div>
    </div> <!-- end chat -->
    <div class="b-table">
        <div class="b-table_">
            <table id="customers" class="table">
                <tr>
                    <th>ID</th>
                    <th>Mail</th>
                    <th>Téléphone</th>
                    <th>Rôle</th>
                    <th>Action</th>
                </tr>
            <% for(var i=0; i < users.length; i++) { %>
                <tr class="lg-story">
                    <td><%= users[i]._id %></td>
                    <td><%= users[i].email %></td>
                    <td><%= users[i].tel %></td>
                    <td>
                        <% if(users[i].role == "1") { %>
                            Admin
                        <% }else{ %>
                            Utilisateur simple
                        <% } %>
                    </td>
                    <td class="action-list">
                        <a href="" class="btn-action-lst btn-info">Infos</a>
                        <a href="/up-user?id=<%= users[i]._id %>" class="btn-action-lst btn-edit">Modifier</a>
                        <a data-id="<%= users[i]._id %>" class="btn-action-lst btn-delete delete">Supprimer</a>
                    </td>
                </tr>
            <% } %>
               
            </table>      
        </div>
    </div>
    
  </div> <!-- end container -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="js/global.js"></script>
  <script>
      $(document).ready(function(){
        $('#searchUser').keyup(function(){
            search_contact().style.display="table-row";
        })
        function search_contact() {
            let input = document.getElementById('searchUser').value
            input=input.toLowerCase();
            let x = document.getElementsByClassName('lg-story');
            
            for (i = 0; i < x.length; i++) { 
                if (!x[i].innerHTML.toLowerCase().includes(input)) {
                    x[i].style.display="none";
                }
                else {
                    x[i].style.display="table-row"; 
                    //console.log(x[i]);            
                }
            }
        }
      })
  </script>
</body>
</html>